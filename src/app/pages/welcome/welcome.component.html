<button class="toggle-main" mat-fab (click)="toggleFlip()">
  {{ isFlipped ? "AC" : "Progetti" }}
</button>

<div class="container" [class.flipped]="isFlipped">
  <div class="section hero">
    <mat-card class="hero-body">
      <div class="header-container">
        <mat-card-header>
          <mat-card-title
            >Benvenuto, <br />
            Sono Andrea Ceccarelli.</mat-card-title
          >
          <mat-card-subtitle>Web Developer</mat-card-subtitle>
        </mat-card-header>
        <img mat-card-image src="../../../assets/img/foto.jpg" alt="foto.jpg" />
      </div>
      <mat-card-actions>
        <button mat-raised-button color="primary" (click)="toggleFlip()">
          Guarda i progetti
        </button>
        <a
          mat-stroked-button
          color="primary"
          href="mailto:tuo.email@esempio.com"
          >Scrivimi</a
        >
      </mat-card-actions>
    </mat-card>
  </div>

  <div class="section projects">
    <div
      class="carousel"
      role="region"
      aria-label="Progetti in evidenza"
      *ngIf="isMobile$ | async; else desktopGrid"
    >
      <div
        #vp
        class="viewport"
        (scroll)="onScroll(vp)"
        tabindex="0"
        aria-live="polite"
      >
        <div class="slide" *ngFor="let project of projects">
          <mat-card class="card">
            <h2>I miei progetti</h2>

            <div class="card-inner" [class.flipped]="project.isFlipped">
              <div class="card-front">
                <img
                  mat-card-image
                  [src]="project.img"
                  [alt]="project.title || 'project'"
                />
              </div>
              <div class="card-back">
                <mat-card-header>
                  <mat-card-title class="project-title">{{
                    project.title
                  }}</mat-card-title>
                </mat-card-header>

                <mat-card-content>
                  <p class="project-desc">{{ project.description }}</p>

                  <mat-chip-set *ngIf="project.techs?.length" class="tech-list">
                    <mat-chip *ngFor="let tech of project.techs" selected>{{
                      tech
                    }}</mat-chip>
                  </mat-chip-set>
                </mat-card-content>

                <div class="carousel-nav-container">
                  <button
                    mat-mini-fab
                    class="nav prev"
                    (click)="prev(vp)"
                    aria-label="Precedente"
                  >
                    <mat-icon>chevron_left</mat-icon>
                  </button>
                  <button
                    mat-mini-fab
                    class="nav next"
                    (click)="next(vp)"
                    aria-label="Successivo"
                  >
                    <mat-icon>chevron_right</mat-icon>
                  </button>
                </div>
              </div>
            </div>
          </mat-card>
        </div>
      </div>

      <!-- indicatori -->
      <div class="dots-container">
        <div class="dots" *ngIf="projects.length > 1">
          <button
            mat-icon-button
            *ngFor="let _ of projects; let i = index"
            [class.active]="i === currentIndex"
            (click)="goTo(i, vp)"
            [attr.aria-label]="'Vai alla slide ' + (i + 1)"
          >
            <span class="dot"></span>
          </button>
        </div>
      </div>
    </div>

    <!-- DESKTOP -->
    <ng-template #desktopGrid>
      <div class="projects-grid">
        <mat-card class="card" *ngFor="let project of projects">
          <div class="card-inner" [class.flipped]="project.isFlipped">
            <div class="card-front">
              <img mat-card-image [src]="project.img" alt="project.png" />
              <button
                mat-stroked-button
                color="primary"
                class="flip-btn"
                (click)="toggleCardFlip(project)"
              >
                Info
              </button>
            </div>
            <div class="card-back">
              <mat-card-header>
                <mat-card-title class="project-title">{{
                  project.title
                }}</mat-card-title>
              </mat-card-header>

              <mat-card-content>
                <p class="project-desc">
                  <span class="desc-inner" data-debug="CIAO">{{
                    project.description
                  }}</span>
                </p>

                <mat-chip-set *ngIf="project.techs?.length" class="tech-list">
                  <mat-chip *ngFor="let tech of project.techs" selected>{{
                    tech
                  }}</mat-chip>
                </mat-chip-set>
              </mat-card-content>

              <button
                mat-stroked-button
                color="primary"
                class="flip-btn"
                (click)="toggleCardFlip(project)"
              >
                Torna
              </button>
            </div>
          </div>
        </mat-card>
      </div>
    </ng-template>
  </div>
</div>
